<!DOCTYPE html>
<html>

<head>
  <title>factgenie</title>
  <meta name="viewport" content="width=1024">
  <link rel="stylesheet" media="screen" href="{{ host_prefix }}/static/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="{{ host_prefix }}/static/css/custom.css">
  <link rel="shortcut icon" href="{{ host_prefix }}/static/img/favicon.ico">
  <link href="{{ host_prefix }}/static/css/font-awesome.css" rel="stylesheet">
  <script src="{{ host_prefix }}/static/js/jquery.min.js"></script>
  <script src="{{ host_prefix }}/static/js/popper.min.js"></script>
  <script src="{{ host_prefix }}/static/js/bootstrap.min.js"></script>
</head>

<body>
  <nav class="navbar navbar-light bg-annotate justify-content-center">
    <a class="navbar-brand" href="{{ host_prefix }}/">
      <img src="{{ host_prefix }}/static/img/genie.png" width="25px">
      <span style="margin-left: 5px; font-weight: bold;">factgenie</span>
    </a>
  </nav>
</body>

<div class="container w-50 mt-5">

  <div class="mt-5">
    <a href="{{ host_prefix }}/llm_eval" class="btn btn-outline-secondary mb-5">‚Üê List of LLM evals</a>
    <h3><b>{{ campaign_id }}</b></h3>

    <div id="metadata-block" class="mt-3">
      <hr>
      <dl class="row">
        <dt class="col-sm-3"> Created </dt>
        <dd class="col-sm-9"> {{ metadata.created }} </dd>
        <dt class="col-sm-3"> Status </dt>
        <dd class="col-sm-9"> {{ metadata.status }} </dd>
        <dt class="col-sm-3"> Metric </dt>
        <dd class="col-sm-9"> {{ metadata.metric }} </dd>
        <dt class="col-sm-3"> Examples </dt>
        <dd class="col-sm-9"> {{ finished_examples | length }} / {{ overview | length }} </dd>
      </dl>
      <div>
        <a onclick="runLlmEval('{{ campaign_id }}')" class="btn btn-outline-secondary" data-bs-toggle="tooltip"
          title="Run evaluation">
          <i class="fa fa-play"></i> Run evaluation
        </a>
        <a onclick="stopLlmEval('{{ campaign_id }}')" class="btn btn-outline-secondary" data-bs-toggle="tooltip"
          title="Run evaluation">
          <i class="fa fa-stop"></i> Stop evaluation
        </a>
      </div>
      <div class="progress mt-3">
        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0"
          aria-valuemax="100" style="width: {{ (finished_examples|length) / (overview | length) * 100 }}%">
        </div>
      </div>
      <hr>
    </div>

    <div id="progress-block" class="mt-3">

      <div id="finished-examples" class="mt-3">
        <h4>Examples</h4>
        <div id="llm-status">
          <table class="table table-sm table-striped">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Dataset</th>
                <th scope="col">Setup</th>
                <th scope="col">Split</th>
                <th scope="col">Example</th>
                <th scope="col">Status</th>
                <th scope="col">Annotations</th>
              </tr>
            </thead>
            <tbody>
              {% for example in overview %}
              <tr>
                <td>{{ loop.index }}</td>
                <td>{{ example.dataset }}</td>
                <td>{{ example.setup_id }}</td>
                <td>{{ example.split }}</td>
                <td>{{ example.example_idx }}</td>
                <td>{{ example.status }}</td>
                <!-- use collapse for hiding annotations -->
                <td>
                  <a class="btn btn-sm btn-outline-secondary" data-bs-toggle="collapse"
                    href="#collapseExample{{ example.dataset }}-{{ example.split }}-{{ example.setup_id }}-{{ example.example_idx }}"
                    role="button" aria-expanded="false" aria-controls="collapseExample" {% if example.status
                    !="finished" %} style="display: none;" {% endif %}>
                    <i class="fa fa-eye"></i> Show
                  </a>
                </td>
              <tr class="collapse"
                id="collapseExample{{ example.dataset }}-{{ example.split }}-{{ example.setup_id }}-{{ example.example_idx }}">
                <td colspan="6">
                  <div class="card card-body">
                    <pre>{{ example.annotations }}</pre>
                  </div>
                </td>
              </tr>
              </tr>
              <tr>

              </tr>
              {% endfor %}
            </tbody>

        </div>
      </div>



    </div>
  </div>
  <script>
    // variable to be used in factgenie.js
    window.url_prefix = "{{ host_prefix }}";
    window.campaigns = "{{ campaigns }}";
  </script>
  <script src="{{ host_prefix }}/static/js/factgenie.js"></script>